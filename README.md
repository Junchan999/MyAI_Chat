# Ｍｙチャット履歴 Ver1.06

「Ｍｙチャット履歴」は、Gemini APIを利用してAIとチャットを行い、その会話履歴を簡単に保存・管理できるローカルアプリケーションです。AIによる会話の要約生成、画像添付、音声入力、PDFエクスポートなど、豊富な機能を備えています。

**【重要】** 本アプリケーションは、すべてのデータ（APIキー、会話履歴、設定など）をブラウザのローカルストレストレージに保存します。外部サーバーには一切データが送信・保存されません。

## 目次

1.  [機能](#機能)
2.  [技術スタック](#技術スタック)
3.  [セットアップ](#セットアップ)
4.  [使い方](#使い方)
5.  [カスタマイズ](#カスタマイズ)
6.  [注意事項](#注意事項)
7.  [ライセンス](#ライセンス)

## 機能

### 1. AIとのチャット

-   **テキスト入力と送信**: `Enter`キーでメッセージを送信し、`Shift + Enter`で改行できます。
-   **画像添付**: クリップボタン (`📎`) をクリックするか、テキスト入力欄に画像を直接ペーストすることで、画像を添付して送信できます。
-   **音声入力**: マイクボタン (`🎤`) をクリックして、音声でメッセージを入力できます。
-   **絵文字入力**: 入力欄の上部に表示される絵文字ボタンで、よく使う絵文字を素早く入力できます。
-   **メッセージの削除**: チャットボックス内の各メッセージをクリックで選択し、ヘッダーの「**選択を削除**」ボタンで削除できます。
-   **メッセージの編集**: 選択したメッセージをヘッダーの「**選択を編集**」ボタンから編集できます。

### 2. チャットの保存と履歴管理

-   **チャット保存**: ヘッダーの「**チャット保存**」ボタンをクリックすると、現在の会話履歴がAIによって分析され、タイトルと要約が生成されます。生成されたタイトル、要約、会話履歴はJSON形式でブラウザのローカルストレージに保存されると共に、Markdown形式のファイルとしてダウンロードされます。
-   **履歴一覧**: ヘッダーの「**履歴一覧**」ボタンから、保存されたチャット履歴のリストを表示できます。リスト内を検索したり、日付やタイトルで並べ替えたり、複数の履歴を選択して一括削除したり、選択した履歴を読み込んだりすることが可能です。
-   **PDFプレビュー**: 「チャット保存」または「履歴一覧」から履歴を読み込んだ後、ヘッダーの「**PDFプレビュー**」ボタンで、現在のチャット履歴のPDFプレビューを表示・ダウンロードできます。
-   **新しいチャット**: ヘッダーの「**新しいチャット**」ボタンをクリックすると、現在の会話を破棄して新しいチャットを開始します。

### 3. 各種設定とAPIキー管理

-   **各種設定**: ヘッダーの「**各種設定**」ボタンから、以下の項目を設定できます。
    -   **AIの性格（システムプロンプト）**: AIの応答の仕方や人格を設定します。
    -   **自動応答プロンプト**: 自動応答時のAIへの指示を設定します。（現在、自動応答タイマー機能は削除されていますが、将来的な拡張のためにプロンプト設定は残しています。）
    -   **チャット概要生成プロンプト**: チャット保存時にAIが概要を生成する際の指示を設定します。`{CONVERSATION_HISTORY}`に変数が挿入されます。
    -   **会話履歴の名前設定**: あなたとAIの表示名を変更できます。
    -   **サウンド設定**: AI応答時の通知サウンドのON/OFFとサウンドタイプを選択できます。
    -   **設定のCSV保存/読込**: 現在の設定内容をCSVファイルとしてエクスポートしたり、CSVファイルから読み込んだりできます。
-   **API設定**: ヘッダーの「**API設定**」ボタンから、Gemini APIキーの入力、テスト、保存、削除ができます。
-   **全チャット履歴のエクスポート/インポート**: 「各種設定」モーダル内で、保存されている全チャット履歴をJSONファイルとしてエクスポートしたり、JSONファイルからインポートして既存の履歴にマージしたり、上書きしたりできます。

### 4. 取扱説明書

-   ヘッダーの「**取扱説明書**」ボタンをクリックすると、このREADMEの内容をブラウザの新しいウィンドウで表示します。

## 技術スタック

-   **フロントエンド**: HTML, CSS, JavaScript
-   **AIモデル**: Google Gemini API (`gemini-2.0-flash`)
-   **PDF生成**: html2pdf.js
-   **音声認識**: Web Speech API (`SpeechRecognition`)

## セットアップ

1.  **ファイルをダウンロード**: この `index.html` ファイルを任意の場所に保存します。
2.  **ブラウザで開く**: 保存した `index.html` ファイルをWebブラウザ（Google Chrome, Firefoxなど）で開きます。
3.  **Gemini APIキーの取得**: Google AI Studio（[https://aistudio.google.com/](https://aistudio.google.com/)）で、Gemini APIキーを生成します。
4.  **APIキーの設定**:
    -   アプリケーションのヘッダーにある「**API設定**」ボタンをクリックします。
    -   開いたモーダルに取得したGemini APIキーを入力し、「**保存**」ボタンをクリックします。
    -   「**APIキーをテスト**」ボタンでキーの有効性を確認できます。

## 使い方

### チャット開始

-   APIキーが設定されると、AIからの挨拶が表示されます。
-   テキスト入力欄にメッセージを入力し、`Enter`キーを押すか、飛行機アイコン (`✈️`) ボタンをクリックして送信します。
-   画像や音声入力も活用して、AIとの対話を楽しんでください。

### 会話の保存

-   会話が一段落したら、ヘッダーの「**チャット保存**」ボタンをクリックします。
-   AIが会話内容から自動的にタイトルと概要を生成し、ローカルに保存されます。

### 過去の履歴を閲覧・読み込み

-   ヘッダーの「**履歴一覧**」ボタンをクリックします。
-   保存されたチャット履歴のリストが表示されるので、目的の履歴を選択して「**選択を読込**」ボタンをクリックします。
-   読み込まれた履歴がチャットボックスに表示され、そこからさらにチャットを続けることも可能です。

### PDFで出力

-   チャットボックスに表示されている履歴（保存済みの履歴を読み込んだ状態、または新規チャットを保存した直後）の状態で、ヘッダーの「**PDFプレビュー**」ボタンをクリックします。
-   PDFのプレビューが表示され、「**PDFをダウンロード**」ボタンでPDFファイルを保存できます。

### 各種設定の変更

-   ヘッダーの「**各種設定**」ボタンをクリックし、好みに合わせてAIの性格、名前、サウンドなどの設定を変更し、「**保存**」ボタンで確定します。

## カスタマイズ

-   **AIの性格（システムプロンプト）**: 「各種設定」の「AIの性格」テキストエリアで、AIに与える指示を変更することで、AIの応答スタイルを自由に調整できます。例がいくつか提供されています。
-   **チャット概要生成プロンプト**: 「各種設定」の「チャット概要生成プロンプト」テキストエリアで、チャット保存時のAIの概要生成方法を細かく指示できます。`{CONVERSATION_HISTORY}`をプロンプト内に含めることで、実際の会話履歴がその位置に挿入されます。
-   **ユーザー/AIの名前**: 「各種設定」で「あなたの名前」と「AIの名前」を変更できます。
-   **サウンド設定**: AI応答時のサウンドの有無や種類を「各種設定」で変更できます。

## 注意事項

-   **データ保存**: すべてのデータはブラウザのローカルストレージに保存されます。ブラウザのキャッシュクリアやストレージデータの削除を行うと、データが完全に失われますのでご注意ください。重要な履歴は定期的にMarkdownファイルやJSONファイルとしてエクスポートすることをお勧めします。
-   **Gemini API利用料金**: Gemini APIの利用には、Googleアカウントが必要です。API利用に伴う料金は、APIキーを発行したご自身のGoogleアカウントに準じます。利用量にご注意ください。
-   **オフライン利用**: APIキー設定後であれば、基本的なチャット履歴の閲覧、保存、設定変更はオフラインでも可能ですが、AIとのチャット機能およびAIによる概要生成機能はインターネット接続が必要です。

## ライセンス

このプロジェクトは特定のライセンスを指定していません。
個人の学習や利用に自由にお使いください。
ただし、本コードの使用によって生じた問題については、一切責任を負いません。

---
